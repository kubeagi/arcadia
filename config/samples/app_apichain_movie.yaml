apiVersion: arcadia.kubeagi.k8s.com.cn/v1alpha1
kind: Application
metadata:
  name: movie-bot
  namespace: arcadia
spec:
  displayName: "æœç´¢ç”µå½±çš„Bot"
  description: ""
  prologue: "Hello, I am KubeAGI BotğŸ¤–, Tell me something?"
  nodes:
    - name: Input
      displayName: "ç”¨æˆ·è¾“å…¥"
      description: "ç”¨æˆ·è¾“å…¥èŠ‚ç‚¹ï¼Œå¿…é¡»"
      ref:
        kind: Input
        name: Input
      nextNodeName: ["prompt-node"]
    - name: prompt-node
      displayName: "prompt"
      description: "è®¾å®špromptï¼Œtemplateä¸­å¯ä»¥ä½¿ç”¨{{xx}}æ¥æ›¿æ¢å˜é‡"
      ref:
        apiGroup: prompt.arcadia.kubeagi.k8s.com.cn
        kind: Prompt
        name: movie-bot
      nextNodeName: ["chain-node"]
    - name: llm-node
      displayName: "zhipuå¤§æ¨¡å‹æœåŠ¡"
      description: "è®¾å®šå¤§æ¨¡å‹çš„è®¿é—®ä¿¡æ¯"
      ref:
        apiGroup: arcadia.kubeagi.k8s.com.cn
        kind: LLM
        name: app-shared-llm-service
      nextNodeName: ["chain-node"]
    - name: chain-node
      displayName: "apichain"
      description: "chainæ˜¯langchainçš„æ ¸å¿ƒæ¦‚å¿µï¼ŒapiChainç”¨äºä»ç‰¹å®šçš„apiæ–‡æ¡£ä¸­æ„å»ºapiè¯·æ±‚ï¼Œå¹¶å°†ç»“æœä¼ é€’ç»™LLMæ¥å›ç­”é—®é¢˜"
      ref:
        apiGroup: chain.arcadia.kubeagi.k8s.com.cn
        kind: APIChain
        name: movie-bot
      nextNodeName: ["Output"]
    - name: Output
      displayName: "æœ€ç»ˆè¾“å‡º"
      description: "æœ€ç»ˆè¾“å‡ºèŠ‚ç‚¹ï¼Œå¿…é¡»"
      ref:
        kind: Output
        name: Output
---
apiVersion: prompt.arcadia.kubeagi.k8s.com.cn/v1alpha1
kind: Prompt
metadata:
  name: movie-bot
  namespace: arcadia
  annotations:
    arcadia.kubeagi.k8s.com.cn/input-rules: '[{"kind":"Input","length":1}]'
    arcadia.kubeagi.k8s.com.cn/output-rules: '[{"length":1}]'
spec:
  displayName: "è®¾å®šå¯¹è¯çš„prompt"
  description: "è®¾å®šå¯¹è¯çš„prompt"
  userMessage: | 
    è¯·å›ç­”æˆ‘çš„é—®é¢˜ï¼š{{.question}}
---
apiVersion: chain.arcadia.kubeagi.k8s.com.cn/v1alpha1
kind: APIChain
metadata:
  name: movie-bot
  namespace: arcadia
  annotations:
    arcadia.kubeagi.k8s.com.cn/input-rules: '[{"kind":"LLM","group":"arcadia.kubeagi.k8s.com.cn","length":1},{"kind":"prompt","group":"prompt.arcadia.kubeagi.k8s.com.cn","length":1}]'
    arcadia.kubeagi.k8s.com.cn/output-rules: '[{"kind":"Output","length":1}]'
spec:
  displayName: "api chain"
  description: "api chain"
  memory:
    conversionWindowSize: 2
  model: glm-4 # notice: default model chatglm_lite or chatglm_turbo gets poor results in most cases, openai's gpt-3.5-turbo is also good enough
  apiDoc: |
    æä¾›å¦‚ä¸‹APIæ¥å£ï¼š
    https://api.wmdb.tv/api/v1/movie/search?q=è‹±é›„æœ¬è‰²&limit=10&lang=Cn
    å…¶ä¸­ï¼Œqä¸ºæœç´¢é¡¹ï¼Œå¿…å¡«ã€‚å¦‚æœæ˜¯ä¸­æ–‡ï¼Œè¯·ä½¿ç”¨urlencodeå¯¹è¿™ä¸ªå­—æ®µè¿›è¡Œç¼–ç ï¼Œè‹±æ–‡åˆ™ä¸éœ€è¦
    limitä¸ºæœç´¢æ¡æ•°ï¼Œå¯é€‰ï¼Œé»˜è®¤å¡«10
    langä¸ºæœç´¢è¯­è¨€ï¼Œå¯é€‰ï¼Œé»˜è®¤å¡«Cn
